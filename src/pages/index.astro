---
import { getCollection } from "astro:content";
import Baz from "../layouts/Baz.astro";
import { Icon } from "astro-icon/components";

const pageTitle = "index";

const allThoughts = await getCollection(
    "thoughts",
    ({ data }) => data.draft !== true,
);
allThoughts.sort((a: any, b: any) => b.data.published - a.data.published);

const allBits = await getCollection("bits", ({ data }) => data.draft !== true);
allBits.sort((a: any, b: any) => b.data.published - a.data.published);

const RDAPIKEY = import.meta.env.RDAPIKEY;
const collectionId = import.meta.env.RDCOLLECTIONID;



// get the latest 10 raindrop links
var bearer = "Bearer " + RDAPIKEY;
var rdUrl = `https://api.raindrop.io/rest/v1/raindrops/${collectionId}?perpage=10`;

async function fetchLinks() {
    const resp = await fetch(rdUrl, {
        method: "GET",
        credentials: "include",
        headers: {
            Authorization: bearer,
            "Content-Type": "application/json",
        },
    });
    const data = await resp.json();
    return data;
}

interface RaindropItem {
    link: string;
    title: string;
    note: string;
    excerpt: string;
    created: string;
}

const links = await fetchLinks();
---

<Baz pageTitle={pageTitle}>
    <div class="hero">
        <video autoplay muted playsinline loop>
            <source src="/effect.webm" type="video/webm" />
            Your browser does not support the video tag.
        </video>
    </div>
    <header class="intro">
        <h1>Kenan Akinci</h1>
        <p class="role">Sr. Hardware Design Engineer</p>
    </header>

    <section class="bio">
        <p>
            I'm a senior hardware design engineer from Germany with over 10
            years of experience in designing and developing hardware for power
            electronics systems. Although not officially a software engineer, I
            program in various languages for personal and professional projects
            too.
        </p>
        <p>
            I dabble here at this website and I believe everyone should have
            their own place in web and freely express themselves the way they
            want. This is therefore my place where I post about
            hardware/software and other things that interest me. I write mostly
            for myself, but maybe you find them interesting too.
        </p>
        <p>
            Check out my <a href="/about">about</a> page for further details on my
            professional career.
        </p>
        <p class="muted">
            P.S. This site is constantly being re-designed and re-organized,
            since it is serving me as a playground for my dabbling as well.
        </p>
    </section>

    <section class="writings">
        <div class="columns">
            <div class="column">
                <h2 class="section-heading">Thoughts</h2>
                <div class="posts-list">
                    {
                        allThoughts.map((post) => (
                            <article class="post-item">
                                <a
                                    href={`/thoughts/${post.id}`}
                                    class="post-title"
                                >
                                    <Icon name="ph:feather-duotone" size="20" />{post.data.title}
                                </a>
                            </article>
                        ))
                    }
                </div>
            </div>
            <div class="column">
                <h2 class="section-heading">Bits</h2>
                <div class="posts-list">
                    {
                        allBits.map((post) => (
                            <article class="post-item">
                                <a href={`/bits/${post.id}`} class="post-title">
                                    <Icon name="ph:asterisk-fill" size="20" />{post.data.title}
                                </a>
                            </article>
                        ))
                    }
                </div>
            </div>
        </div>
    </section>

    <section class="bookmarks">
        <h2 class="section-heading">Latest bookmarks</h2>
        <div class="posts-list">
          {
            links.items.map((item: RaindropItem) => (
            <article class="post-item">
                <a href=`${item.link}` target="_blank" class="post-title">
                    <Icon name="ph:bookmark-duotone" size="20"/>{item.title}
                </a>
            </article>
            ))
          }
          <a href="/bookmarks">see more</a>
        </div>
    </section>

    <section class="elsewhere">
        <h2 class="section-heading">Elsewhere</h2>
        <p>
            You can find me on <a href="https://mas.to/@ingenieur"
                >Mastodon<Icon name="ph:mastodon-logo-duotone" size="16" /></a
            >, <a href="https://github.com/kenandotfyi"
                >GitHub<Icon name="ph:github-logo-duotone" size="16" /></a
            > or contact me directly via <b>hey@kenan.fyi</b>. I always
            appreciate a meaningful and friendly conversation on topics such as
            software development, design, minimalism, electronics and
            non-fiction books.
        </p>
        <p>
            If you like to use RSS, I also have a feed which you can find <a
                href="https://kenan.fyi/rss.xml">here</a
            >.
        </p>
    </section>
</Baz>

<style>
    :global(body) {
        max-width: 70ch;
    }

    .intro {
        margin-bottom: calc(var(--q) * 4);
    }

    .intro h1 {
        font-size: 2rem;
        margin: 0;
    }

    .role {
        font-size: 1.1rem;
        color: var(--text-muted);
        margin: 0;
    }

    .hero {
        margin-bottom: calc(var(--q) * 8);
        margin-inline: clamp(-5%, calc(-50vw + 50% + 1rem), 0px);
    }

    .hero video {
        width: 100%;
        border-radius: var(--border-m);
    }

    .bio {
        margin-bottom: calc(var(--q) * 12);
        text-align: justify;
        hyphens: auto;
    }

    .bio p {
        margin-bottom: calc(var(--q) * 4);
    }

    .bio .muted {
        font-style: italic;
        color: var(--text-muted);
    }

    /* Two-column writings */
    .writings {
        margin-bottom: calc(var(--q) * 12);
    }

    .columns {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: calc(var(--q) * 4);
    }

    .section-heading {
        text-transform: uppercase;
        letter-spacing: 0.08em;
        color: var(--text-muted);
        margin-top: 0;
        margin-bottom: calc(var(--q) * 4);
        padding-bottom: calc(var(--q) * 2);
        border-bottom: 1px solid var(--panel-border);
    }

    .posts-list {
        display: flex;
        flex-direction: column;
    }

    .post-item {
        display: flex;
        align-items: baseline;
        gap: calc(var(--q) * 3);
    }

    .post-title {
        font-size: 18px;
        flex: 1;
    }

    .post-title :global(svg) {
        vertical-align: middle;
        opacity: 0.5;
        margin-right: 2px;
        position: relative;
        top: -1px;
    }

    /* Elsewhere */
    .elsewhere {
        margin-bottom: calc(var(--q) * 12);
    }

    /* Experience */
    .experience {
        margin-bottom: calc(var(--q) * 12);
    }

    .jobs {
        display: flex;
        flex-direction: column;
        gap: calc(var(--q) * 6);
    }

    .job {
        padding: calc(var(--q) * 4);
        border: 1px solid var(--panel-border);
        border-radius: var(--border-m);
    }

    .job h3 {
        margin: 0;
    }

    .job > p:first-of-type {
        margin: 0;
        color: var(--text-muted);
        font-size: 0.95rem;
    }

    .tenure {
        font-style: italic;
        color: var(--text-muted);
        font-size: 0.9em;
    }

    .current-marker::before {
        content: "\25CF";
        color: var(--accent);
        margin-right: 6px;
        font-size: 0.7em;
    }

    /* Papers */
    .papers {
        margin-bottom: calc(var(--q) * 12);
    }

    @media (max-width: 768px) {
        .columns {
            grid-template-columns: 1fr;
            gap: calc(var(--q) * 8);
        }
    }
</style>
