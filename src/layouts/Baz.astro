---
import Nav from "../components/Nav.astro";
import Footer from "../components/Footer.astro";
import "../styles/global.css";
import "@fontsource/ibm-plex-mono";
import "@fontsource/ibm-plex-sans";
import "@fontsource/ibm-plex-serif";

const { pageTitle, description, ogImage, wide } = Astro.props;

const siteUrl = Astro.site ?? "https://kenan.fyi";
const canonicalUrl = new URL(Astro.url.pathname, siteUrl).toString();
const ogTitle = pageTitle ? `kenan.fyi / ${pageTitle}` : "kenan.fyi";
const ogDescription =
    description ?? "Hardware engineer, occasional programmer, dabbler.";
const ogImageUrl = ogImage
    ? new URL(ogImage, siteUrl).toString()
    : new URL("/og-default.png", siteUrl).toString();
---

<!doctype html>
<html lang="en">
    <head>
        <script is:inline>
            (function () {
                const stored = localStorage.getItem("theme");
                if (stored === "light") {
                    document.documentElement.setAttribute(
                        "data-theme",
                        "light",
                    );
                }
            })();
        </script>
        <meta charset="utf-8" />
        <link rel="me" href="https://mas.to/@ingenieur" />
        <link href="https://github.com/kenandotfyi" rel="me" />
        <link
            rel="apple-touch-icon"
            sizes="180x180"
            href="/apple-touch-icon.png"
        />
        <link
            rel="icon"
            type="image/png"
            sizes="32x32"
            href="/favicon-32x32.png"
        />
        <link
            rel="icon"
            type="image/png"
            sizes="16x16"
            href="/favicon-16x16.png"
        />

        <link
            rel="alternate"
            type="application/rss+xml"
            title="kenan.fyi"
            href={new URL("rss.xml", Astro.site)}
        />
        <meta name="generator" content={Astro.generator} />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>{ogTitle}</title>
        <meta name="description" content={ogDescription} />
        <link rel="canonical" href={canonicalUrl} />

        <!-- Open Graph -->
        <meta property="og:type" content="website" />
        <meta property="og:url" content={canonicalUrl} />
        <meta property="og:title" content={ogTitle} />
        <meta property="og:description" content={ogDescription} />
        <meta property="og:image" content={ogImageUrl} />
        <meta property="og:site_name" content="kenan.fyi" />

        <!-- Twitter / X -->
        <meta name="twitter:card" content="summary_large_image" />
        <meta name="twitter:title" content={ogTitle} />
        <meta name="twitter:description" content={ogDescription} />
        <meta name="twitter:image" content={ogImageUrl} />
        <script
            defer
            src="https://meter.akinci.fyi/script.js"
            data-website-id="2fc8e433-d5b5-4815-8009-136f9d837057"></script>
    </head>
    <body class:list={[{ wide }]}>
        <Nav />
        <main>
            <slot />
        </main>
        <slot name="panels-outside-main" />
        <Footer />
    </body>
</html>

<style>
    body {
        display: flex;
        flex-direction: column;
        min-height: 100vh;
    }

    main {
        flex: 1;
        animation: fadeInFocus 0.4s cubic-bezier(0.25, 0.1, 0.25, 1);
        padding-bottom: calc(var(--q) * 12);
    }

    @keyframes fadeInFocus {
        from {
            opacity: 0;
            filter: blur(3px);
        }
        to {
            opacity: 1;
            filter: blur(0);
        }
    }
</style>
